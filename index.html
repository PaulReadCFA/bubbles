<!DOCTYPE html>
<script>
(function(){
  function placeBubbles(){
    const map = document.getElementById('map');
    const overlay = document.getElementById('overlay');
    const topImg = map.querySelector('img[data-panel="top"]');
    const bottomImg = map.querySelector('img[data-panel="bottom"]');
    const topH = topImg.getBoundingClientRect().height;
    const bottomH = bottomImg.getBoundingClientRect().height;
    const totalH = topH + bottomH;

    overlay.querySelectorAll('a[data-x]').forEach(a=>{
      const x = parseFloat(a.dataset.x);
      const y = parseFloat(a.dataset.y);
      const d = parseFloat(a.dataset.d);
      const layer = (a.dataset.layer || 'top').toLowerCase();

      // Convert "y within that image" -> "y within combined overlay"
      let yPctOfTotal;
      if(layer === 'top'){
        yPctOfTotal = ((y/100) * topH) / totalH * 100;
      }else{
        yPctOfTotal = ((topH + (y/100) * bottomH) / totalH) * 100;
      }

      a.style.left = x + '%';
      a.style.top = yPctOfTotal + '%';
      a.style.width = d + 'px';
      a.style.height = d + 'px';
      a.setAttribute('tabindex','0'); // keyboard focus for tooltip
    });
  }
  window.addEventListener('load', placeBubbles);
  window.addEventListener('resize', placeBubbles);
})();
</script>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CFA Bubble Quad</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <main class="quad" aria-label="Job role discovery">
<div class="map" id="map">
  <img class="panel-img" data-panel="top" src="top.jpg" alt="">
  <img class="panel-img" data-panel="bottom" src="bottom.jpg" alt="">

  <div class="overlay" id="overlay">
    <!-- Mark which image each bubble belongs to via data-layer -->
    <!-- Keep your original % x/y and pixel diameter d -->
    <a href="https://interactive.cfainstitute.org/bubble-quiz-CIO"
       data-x="27" data-y="64" data-d="40" data-layer="top"
       data-tip="CIO" title="CIO" aria-label="CIO"></a>

    <a href="https://interactive.cfainstitute.org/bubble-quiz-Portfolio-manager"
       data-x="46" data-y="38" data-d="26" data-layer="top"
       data-tip="Product Manager" title="Product Manager" aria-label="Product Manager"></a>

    <a href="https://interactive.cfainstitute.org/bubble-quiz-quant-analysis"
       data-x="38" data-y="41" data-d="40" data-layer="top"
       data-tip="Buy-side Quant Analyst" title="Buy-side Quant Analyst" aria-label="Buy-side Quant Analyst"></a>

    <a href="https://interactive.cfainstitute.org/bubble-quiz-ESG-analyst"
       data-x="93" data-y="15" data-d="18" data-layer="top"
       data-tip="ESG Analyst" title="ESG Analyst" aria-label="ESG Analyst"></a>

    <a href="https://interactive.cfainstitute.org/bubble-quiz-credit-analyst"
       data-x="82" data-y="19" data-d="36" data-layer="top"
       data-tip="Sell-side Credit Analyst" title="Sell-side Credit Analyst" aria-label="Sell-side Credit Analyst"></a>

    <a href="https://interactive.cfainstitute.org/bubble-quiz-Economist"
       data-x="69" data-y="26" data-d="34" data-layer="top"
       data-tip="Economist" title="Economist" aria-label="Economist"></a>

    <a href="https://interactive.cfainstitute.org/Bubble-Quiz-Sales"
       data-x="61" data-y="20" data-d="55" data-layer="top"
       data-tip="Sales" title="Sales" aria-label="Sales"></a>

    <a href="https://interactive.cfainstitute.org/bubble-quiz-central-banks"
       data-x="51" data-y="26" data-d="25" data-layer="top"
       data-tip="Central Banks" title="Central Banks" aria-label="Central Banks"></a>

    <a href="https://interactive.cfainstitute.org/Bubble-Quiz-Regulator"
       data-x="45" data-y="22" data-d="36" data-layer="top"
       data-tip="Regulators" title="Regulators" aria-label="Regulators"></a>

    <!-- Add the rest; for bubbles that belong on the BOTTOM image, set data-layer="bottom" -->
  </div>
</div>

  </main>
</body>
</html>
